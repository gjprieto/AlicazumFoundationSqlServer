trigger:
- dev

pool:
  vmImage: ubuntu-latest

stages:

- stage: 'Build'
  variables:
    BUILD_CONFIG: 'Release'
    SOLUTION: 'Alicazum.Foundation.sln'

  jobs:
  - job:
    pool:
      vmImage: 'ubuntu-latest'

    workspace:
      clean: all

    steps:
    - task: UseDotNet@2
      displayName: Setup .NET 8.0
      inputs:
        packageType: "sdk"
        version: "8.0.x"

    - task: DotNetCoreCLI@2
      displayName: Restore project dependencies
      inputs:
        command: 'restore'
        projects: '$(SOLUTION)'

    - task: DotNetCoreCLI@2
      displayName: Build project
      inputs:
        command: 'build'
        projects: '$(SOLUTION)'
        arguments: '/p:Configuration=$(BUILD_CONFIG)'
        
    - task: DotNetCoreCLI@2
      displayName: Run tests
      inputs:
        command: 'test'
        projects: '$(SOLUTION)'
        arguments: '/p:Configuration=$(BUILD_CONFIG)'